# Era Virtual Machine (zkEVM)

**–ê–≤—Ç–æ—Ä:** [–†–æ–º–∞–Ω –Ø—Ä–ª—ã–∫–æ–≤](https://github.com/rlkvrv) üßê

_–í–∞–∂–Ω–æ!_ –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ —É–ª—É—á—à–µ–Ω–∏–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ (–∏–ª–∏ –≤—Å–µ) –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ–ø–∏—Å–∞–Ω—ã –Ω–∏–∂–µ –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å –∏–ª–∏ –ø–æ—Ç–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.

_Note:_ –û–ø–∫–æ–¥—ã –Ω–∏–∂–µ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω—ã –≤ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#create-create2).

## CREATE, CREATE2

–í zkEVM –æ–±—ä–µ–¥–µ–Ω–∏–Ω—ã –∫–æ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (creationCode) –∏ –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (runtimeCode), –∏–∑-–∑–∞ —ç—Ç–æ–≥–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã `datasize` –∏ `dataoffset`.
–ó–¥–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –æ –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:

-   –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∫ –±—ã–ª –ø–æ–ª—É—á–µ–Ω `bytecode`

–ï—Å–ª–∏ –≤ –∫–æ–¥–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ —è–≤–Ω–æ (–Ω–µ —á–µ—Ä–µ–∑ `new`) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `create` –∏–ª–∏ `create2` (—Å –ø–æ–º–æ—â—å—é Yul), —Ç–æ `bytecode` —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ–º–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω –≤ —ç—Ç–æ–º –∂–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ, –ª–∏–±–æ –≤ –¥—Ä—É–≥–æ–º, –Ω–æ —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ `type(T).creationCode`.

–î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä `zksolc` –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç `bytecode` –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ `ContractDeployer`. –ï—Å–ª–∏ –≤–∑—è—Ç—å `bytecode` –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø–æ–ª—É—á–µ–Ω —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ `solc` —ç—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç. –ü—Ä–∏–º–µ—Ä—ã –ø–æ–∫–∞–∑–∞–Ω—ã –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#create-create2:~:text=the%20bytecode%20itself.-,The%20code%20below%20should%20work%20as%20expected%3A,-MyContract%20a%20%3D).

–ë–æ–ª–µ–µ —Ç–æ–≥–æ, bytecode –∏–∑ `artifacts-zk`, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —Å –ø–æ–º–æ—â—å—é `zksolc` —Ç–æ–∂–µ –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç, –≤–æ—Ç –¥–≤–∞ –ø—Ä–∏–º–µ—Ä–∞ –±–∞–π—Ç–∫–æ–¥–∞ –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:

–≠—Ç–æ—Ç –≤–∑—è—Ç –∏–∑ `.json` —Ñ–∞–π–ª–∞ –ø–∞–ø–∫–∏ `artifacts-zk`

```
0x0000008003000039000000400030043f0000000102200190000000120000c13d000000000201001900000009022001980000001a0000613d000000000101043b0000000a011001970000000b0110009c0000001a0000c13d0000000001000416000000000101004b0000001a0000c13d0000002a01000039000000800010043f0000000c010000410000001d0001042e0000000001000416000000000101004b0000001a0000c13d00000020010000390000010000100443000001200000044300000008010000410000001d0001042e00000000010000190000001e000104300000001c000004320000001d0001042e0000001e000104300000000000000000000000020000000000000000000000000000004000000100000000000000000000000000000000000000000000000000fffffffc000000000000000000000000ffffffff00000000000000000000000000000000000000000000000000000000f2c9ecd80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000008000000000000000000000000000000000000000000000000000000000000000000000000000000000fe656f219dacf5ce8b73b813cb9203d0f8598845700707ab67bcbac593600ec9
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –≤ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω:

```solidity
    function createContract(bytes memory bytecode) external returns (address addr) {
        assembly {
            addr := create(0, add(bytecode, 0x20), mload(bytecode))
        }
        require(addr != address(0), "Create: Failed on deploy");
    }
```

–ê –≤–æ—Ç `bytecode` —Ç–æ–≥–æ-–∂–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ type(T).creationCode:

```
0x0000000000000000000000000000000000000000000000000000000000000000000000000100000fad4cfc3855d0e61bd17ecca835f2a2f01ddfdeb9a48d4d5ced5cf98a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

–ü–æ–ª—É—á–µ–Ω –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏:

```solidity
    function getCreationCode() external pure returns (bytes memory) {
        return type(Implementation).creationCode;
    }
```

–≠—Ç–æ—Ç –±–∞–π—Ç–∫–æ–¥ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `createContract`.

-   –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ—Ç –ª–∏ –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö –≤—ã–∑–æ–≤–∞ type(T).runtimeCode

C runtimeCode –ø—Ä–æ—â–µ, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –≤ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤—ã–∑–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä `zksolc` –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è.

-   [–î–µ—Ä–∏–≤–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤](https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#address-derivation)

–¢–∞–∫ –∫–∞–∫ –±–∞–π—Ç-–∫–æ–¥ zkSync –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç Ethereum, –ø–æ—Å–∫–æ–ª—å–∫—É zkSync –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é EVM - –∞–¥—Ä–µ—Å, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ —Ö—ç—à–∞ –±–∞–π—Ç-–∫–æ–¥–∞, —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –±–∞–π—Ç-–∫–æ–¥, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –≤ Ethereum –∏ zkSync, –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –∞–¥—Ä–µ—Å–∞, –∞ –∞–¥—Ä–µ—Å Ethereum –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ zkSync.

_–í–∞–∂–Ω–æ!_ –í –±—É–¥—É—â–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ø–∞—Ä–∏—Ç–µ—Ç —Å Ethereum –≤ –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–æ–≤.

## CALL, STATICCALL, DELEGATECALL

–ó–¥–µ—Å—å –µ—Å—Ç—å –ø–∞—Ä–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π.

–í –≤—ã–∑–æ–≤–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π Yul, —Ç–∞–∫–∏—Ö –∫–∞–∫ `call` (`call`, `callcode`, `delegatecall`, `staticcall`) –º–æ–∂–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–∞–∑–º–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –µ—Å–ª–∏ –æ–Ω –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ `returndatasize` –≤ EVM –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É —Ç–∏–ø–∞ `Panic`. –í zkEVM —Ç–∞–∫–æ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, —Ç.–∫. –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

–≠—Ç–æ –Ω–µ –¥–æ–≤–æ–ª—å–Ω–æ —Ä–µ–¥–∫–∏–π –∫–µ–π—Å, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ—Å–ª–µ —Ö–∞—Ä–¥—Ñ–æ—Ä–∫–∞ Byzantium –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (`outsize`).

–í—Ç–æ—Ä–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∞ —ç—Ñ–∏—Ä–∞ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º `MsgValueSimulator`, –Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å, –≤—Å—è –ª–æ–≥–∏–∫–∞ —Å msg.value –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –∏ –≤ –æ–±—ã—á–Ω–æ–π EVM —Å—Ä–µ–¥–µ.

## MSTORE, MLOAD

–ó–¥–µ—Å—å 3 –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

1. –ü—Ä–∏—Ä–æ—Å—Ç memory –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–π—Ç–∞—Ö –∞ –Ω–µ –≤ —Å–ª–æ–≤–∞—Ö. –ù–∞–ø–æ–º–Ω—é —á—Ç–æ —Å–ª–æ–≤–æ - —ç—Ç–æ 32 –±–∞–π—Ç–∞. –ü–æ—ç—Ç–æ–º—É, –≤ EVM –∫–æ–≥–¥–∞ –º—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∞–¥—Ä–µ—Å—É 100 (`0x64`) - –∏–∑-–∑–∞ —Å–º–µ—â–µ–Ω–∏—è –≤ 4 –±–∞–π—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–≤–∞ memory –±—É–¥–µ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω–∞ –µ—â–µ 28 –±–∞–π—Ç–∞–º–∏ –∏ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–Ω–µ—Ç 160 –±–∞–π—Ç (`0x64` + `0x20` + `0x1c` = `0xa0`).
   –í zkSync —ç—Ç–æ–≥–æ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∏ –≤ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –ø–æ –∞–¥—Ä–µ—Å—É 100 (`0x64`) —Ä–∞–∑–º–µ—Ä memory –±—É–¥–µ—Ç 132 –±–∞–π—Ç–∞ (`0x64` + `0x20` = `0x84`).

2. –í —Å–≤—è–∑–∏ —Å –ø–µ—Ä–≤–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä zksolc –º–æ–∂–µ—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–±–∏—Ä–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –ø–∞–º—è—Ç—å, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ –æ—à–∏–±–∫–µ —Ç–∏–ø–∞ "Panic" –≤ EVM, –Ω–æ –≤ zkEVM –æ—à–∏–±–æ–∫ —ç—Ç–æ –Ω–µ –≤—ã–∑–æ–≤–µ—Ç.

3. –°—Ç–æ–∏–º–æ—Å—Ç—å –≥–∞–∑–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å memory –≤ EVM –∏–º–µ–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π —Ä–æ—Å—Ç - –≤ zkEVM —ç—Ç–æ—Ç —Ä–æ—Å—Ç –±—É–¥–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–º.

## CALLDATALOAD, CALLDATACOPY

–í —ç—Ç–æ–º –ø—É–Ω–∫—Ç–µ –≤—Å–µ –ø—Ä–æ—Å—Ç–æ, —Ä–∞–∑–º–µ—Ä calldata –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –∑–Ω–∞—á–µ–Ω–∏–µ–º 2<sup>32</sup> –±–∞–π—Ç.

## RETURN, STOP

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø–∞ `immutable` –Ω–µ –±—É–¥—É—Ç –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –µ—Å–ª–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –µ—Å—Ç—å assembly –≤—Å—Ç–∞–≤–∫–∞ —Å –≤—ã–∑–æ–≤–æ–º `return(p, s)` –∏–ª–∏ `stop()` –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `immutable`.

## TIMESTAMP, NUMBER, HASH

–í zkSync Era —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –ø–æ–Ω—è—Ç–∏—è –±–ª–æ–∫–æ–≤: –±–ª–æ–∫–∏ L2 –∏ –ø–∞–∫–µ—Ç—ã L1.
–ë–ª–æ–∫–∏ L2 ‚Äî —ç—Ç–æ –±–ª–æ–∫–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ L2 (—Ç–æ –µ—Å—Ç—å –≤ —Å–µ—Ç–∏ zkSync Era), –æ–Ω–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –∏ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ü–µ–ø–æ—á–∫—É Ethereum.
–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –ø–∞–∫–µ—Ç—ã L1 ‚Äî —ç—Ç–æ –ø–∞–∫–µ—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ L2, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –±–ª–æ–∫–∞ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞ –≤ –ø–∞–∫–µ—Ç–µ.

–î–æ —ç—Ç–æ–≥–æ [–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è](https://github.com/zkSync-Community-Hub/zkync-developers/discussions/87) `block.timestamp`, `block.number` –∏ `block.hash` –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–æ–≤ L1. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–Ω–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç–æ–≤ L2, –∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π L1 –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (—Å–µ–π—á–∞—Å —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ API).

## CODECOPY

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CODECOPY c [new Yul codegen](https://docs.soliditylang.org/en/latest/ir-breaking-changes.html#solidity-ir-based-codegen-changes) –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

## EXTCODECOPY

EXTCODECOPY –≤—Å–µ–≥–¥–∞ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º zkEVM.

## DATASIZE, DATAOFFSET, DATACOPY

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥–≤—É–º—è —á–∞—Å—Ç—è–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ zkEVM: –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º, –Ω–∞–∑—ã–≤–∞–µ–º—ã–º ContractDeployer. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Yul, –∞ –Ω–µ —á–µ—Ä–µ–∑ `new` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç—É –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å.

## SETIMMUTABLE, LOADIMMUTABLE

–í zkEVM –¥–æ—Å—Ç—É–ø –∫ –±–∞–π—Ç-–∫–æ–¥—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø–æ—ç—Ç–æ–º—É `immutable` –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ) —Å–∏–º—É–ª–∏—Ä—É—é—Ç —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤. –ö–æ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä) —Å–æ–±–∏—Ä–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –≤–æ–∑–≤—Ä–∞—â–∞—è –µ–≥–æ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –≤ `ContractDeployer`. –ó–∞—Ç–µ–º –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç `ImmutableSimulator`, –≥–¥–µ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å –∞–¥—Ä–µ—Å–æ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –∏–∑ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –∫–æ–¥–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤—ã–∑—ã–≤–∞—é—Ç `ImmutableSimulator`, –∏—Å–ø–æ–ª—å–∑—É—è –∞–¥—Ä–µ—Å –∏ –∏–Ω–¥–µ–∫—Å –∑–Ω–∞—á–µ–Ω–∏—è.

## COINBASE, DIFFICULTY, PREVRANDAO, BASEFEE, SELFDESTRUCT, CALLCODE, PC, CODESIZE

–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è - —Å–º–æ—Ç—Ä–µ—Ç—å [—Ç—É—Ç](https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#coinbase).

## –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –ø—Ä–µ–∫–æ–º–ø–µ–ª—è—Ü–∏–∏

### Libraries

–í zkEVM [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#libraries) —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–∞—á–µ, —á–µ–º –≤ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–º EVM:

–í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ Solidity –¥–æ–ª–∂–µ–Ω –≤—Å—Ç—Ä–æ–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É, —á—Ç–æ–±—ã –µ—ë –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞–ø—Ä—è–º—É—é –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–π—Ç–∫–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, —É—Å—Ç—Ä–∞–Ω—è—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏.

–†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: –ï—Å–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞, –µ—ë –∞–¥—Ä–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞. –í–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —ç—Ç–∏ –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∑–∞–º–µ–Ω—ã –∑–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤ –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ (IR): linkersymbol –≤ Yul –∏–ª–∏ PUSHLIB –≤ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π —Å–±–æ—Ä–∫–µ EVM.

–°–≤—è–∑—ã–≤–∞–Ω–∏–µ –Ω–∞ –≠—Ç–∞–ø–µ –ö–æ–º–ø–∏–ª—è—Ü–∏–∏: –í—Å–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Ç–æ –µ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å –∫–æ–¥–æ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. zkEVM –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è, –∫–æ–≥–¥–∞ –∞–¥—Ä–µ—Å–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –∞ –Ω–µ –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

### Precompiles

–í zkEVM –Ω–µ –≤—Å–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –æ–±—ã—á–Ω–æ–º EVM, –¥–æ—Å—Ç—É–ø–Ω—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–∏ –∏ RSA –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –Ω–æ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ.

–û–¥–Ω–∞–∫–æ –±–∞–∑–æ–≤—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∏–∑ –ø–æ–¥–ø–∏—Å–∏ (ecrecover), —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ keccak256 –∏ sha256, —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –≤ –æ–±—ã—á–Ω–æ–π —Å–µ—Ç–∏ Ethereum, –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ –≤—ã–∑–æ–≤—ã —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∑–∞ –≤–∞—Å.
