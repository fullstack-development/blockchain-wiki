# Uniswap-v3 smart contracts fork

**–ê–≤—Ç–æ—Ä:** [–ê–ª–µ–∫—Å–µ–π –ö—É—Ü–µ–Ω–∫–æ](https://github.com/bimkon144) üë®‚Äçüíª

–í —ç—Ç–æ–º –≥–∞–π–¥–µ –º—ã –ø–æ–∫–∞–∂–µ–º, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ —Ñ–æ—Ä–∫–Ω—É—Ç—å Uniswap V3.

## –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è

–ï—Å—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

- [uniswap-v3-core](https://github.com/Uniswap/v3-core).
- [uniswap-v3-periphery](https://github.com/Uniswap/v3-periphery).

### uniswap-v3-core

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π uniswap-v3-core —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã: `UniswapV3Factory.sol`, `UniswapV3Pool.sol`, `UniswapV3PoolDeployer.sol`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Uniswap V3. –≠—Ç–∏ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–±–º–µ–Ω–∞ —Ç–æ–∫–µ–Ω–∞–º–∏.

–°—Ö–µ–º–∞ –¥–µ–ø–ª–æ—è –Ω–æ–≤–æ–≥–æ –ø—É–ª–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
![alt text](./images/core.png)

`UniswapV3Factory.sol` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª–∞–º–∏ –æ–±–º–µ–Ω–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ–º–∏—Å—Å–∏–π. –°–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ñ–∞–±—Ä–∏–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—É–ª—ã –∏ –∏—Ö –∞–¥—Ä–µ—Å–∞. –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—É–ª —Ç–æ–∫–µ–Ω–æ–≤, —Ñ–∞–±—Ä–∏–∫–∞ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç `UniswapV3Pool.sol` —á–µ—Ä–µ–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç `UniswapV3PoolDeployer.sol`.

### uniswap-v3-periphery

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π uniswap-v3-periphery —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã: `NonfungiblePositionManager.sol`, `NonfungibleTokenPositionDescriptor.sol`, `SwapRouter.sol`, –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: `PoolAddress.sol`, `LiquidityAmounts.sol`, –∏ –¥—Ä—É–≥–∏–µ. –û–Ω–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ –∏–∑ uniswap-v3-core. –≠—Ç–∏ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –æ–±–ª–µ–≥—á–∞—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å:

- `SwapRouter.sol`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±–º–µ–Ω–∞ —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ –ø—É–ª—ã Uniswap V3.
- `NonfungiblePositionManager.sol`. –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏—è–º–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –≤ –≤–∏–¥–µ NFT —Ç–æ–∫–µ–Ω–æ–≤.
- `NonfungibleTokenPositionDescriptor.sol`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è NFT —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–∑–∏—Ü–∏–π.
- `QuoterV2.sol`. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–ø–∞—Ö.
- `UniswapInterfaceMulticall.sol`. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≥—Ä–µ–≥–∞—Ü–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—ã–∑–æ–≤–æ–≤ –≤ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.

_–í–∞–∂–Ω–æ!_ `Multicall2.sol` –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ç–æ–∂–µ –Ω—É–∂–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å. –û–Ω –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ uniswap-v-3-periphery —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é. –û–Ω –ª–µ–∂–∏—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏](https://github.com/makerdao/multicall/blob/master/src/Multicall2.sol). –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—ã–∑–æ–≤–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏ –¥–µ–ø–ª–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤.

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

_–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ [Node.js](https://nodejs.org/en/download/) –∏ [npm](https://www.npmjs.com/get-npm) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ `node --version` –∏ `npm --version`._

–ß—É—Ç—å –ø–æ–∑–∂–µ –º—ã —Ç–∞–∫–∂–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Hardhat –∏ –µ–≥–æ –ø–ª–∞–≥–∏–Ω –¥–ª—è –¥–µ–ø–ª–æ—è - Hardhat ignition.

–ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—à –ø—Ä–æ–µ–∫—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–∏–º –µ–≥–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Uniswap V3.

1) –°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ: 
   ```bash
   mkdir UNISWAP-V3-FORK-SC && cd ./UNISWAP-V3-FORK-SC
   ```

2) –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Hardhat –ø—Ä–æ–µ–∫—Ç:
   ```bash
   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
   npx hardhat init
   ```
  
   –í—ã–±–µ—Ä–∏—Ç–µ "Create a TypeScript project".
   –°–æ–≥–ª–∞—à–∞–µ–º—Å—è –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã.

3) –£—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–ª–∞–≥–∏–Ω—ã Hardhat
   npm install --save-dev @nomicfoundation/hardhat-ignition-ethers @nomicfoundation/hardhat-verify dotenv
   
   # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Uniswap –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   npm install @uniswap/lib @uniswap/v2-core @uniswap/v3-core @uniswap/v3-periphery base64-sol
   ```

4) –°–æ–∑–¥–∞–¥–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –∏ —Å–∫–æ–ø–∏—Ä—É–µ–º Uniswap –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã:
  
  _–ö–æ–ø–∏—Ä—É–µ–º —Ç–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –ø–∞–ø–∫–µ –∞—É–¥–∏—Ç–∞ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è._
  
  _–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –º–æ–∂–µ—Ç–µ –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º, –æ—Ç–ª–∏—á–Ω—ã–º –æ—Ç –Ω–∞—à–µ–≥–æ, –¥–∞–∂–µ –≤—Ä—É—á–Ω—É—é._
   ```bash
   # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
   mkdir -p src/v3-core src/v3-periphery
   
   # –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Uniswap V3 –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
   git clone https://github.com/Uniswap/v3-core.git temp-v3-core
   git clone https://github.com/Uniswap/v3-periphery.git temp-v3-periphery
   
   # –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ –Ω–∞—à—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   cp -r temp-v3-core/contracts/* src/v3-core/
   cp -r temp-v3-periphery/contracts/* src/v3-periphery/
   
   # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
   rm -rf temp-v3-core temp-v3-periphery
   
   # –°–æ–∑–¥–∞–µ–º Multicall2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç
   curl -o src/Multicall2.sol https://raw.githubusercontent.com/makerdao/multicall/master/src/Multicall2.sol

   # –°–æ–∑–¥–∞–µ–º WETH –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è —Ç–µ—Å—Ç–Ω–µ—Ç–∞. –î–ª—è –ú–µ–π–Ω–Ω–µ—Ç–∞ –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤ .env.
   
   curl -o src/WETH9.sol https://raw.githubusercontent.com/gnosis/canonical-weth/master/contracts/WETH9.sol
   ```

5) –ù–∞—Å—Ç—Ä–æ–∏–º —Ñ–∞–π–ª `hardhat.config.ts`:
   ```typescript
   import { HardhatUserConfig } from "hardhat/config";
   import "@nomicfoundation/hardhat-toolbox";
   import "@nomicfoundation/hardhat-ignition-ethers";
   import "@nomicfoundation/hardhat-verify";
   import 'dotenv/config';

   const PRIVATE_KEY= process.env.PRIVATE_KEY as string;

   const AMOY_RPC_URL = process.env.AMOY_RPC_URL;

   const POLYGON_API_KEY = process.env.POLYGON_API_KEY || '';

   const config: HardhatUserConfig = {
     solidity: {
       compilers: [
         {
           version: "0.7.6",
           settings: {
             optimizer: {
               enabled: true,
               runs: 200,
               details: {
                 yul: true
               }
             },
             viaIR : false,
           },
         },
         {
           version: "0.4.22"
         }
       ]
     },
     paths: {
       sources: "./src"
     },
     networks: {
       amoy: {
         url: AMOY_RPC_URL,
         accounts: [PRIVATE_KEY],
       }
     },
     etherscan: {
       apiKey: {
         amoy: POLYGON_API_KEY
       },
       customChains: [{
         network: "amoy",
         chainId: 80002,
         urls: {
           apiURL: "https://api-amoy.polygonscan.com/api",
           browserURL: "https://amoy.polygonscan.com"
         }
       }]
     }
   };

   export default config;
   ```

6) –°–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª .env - `cp .env.example .env` –∏ –∑–∞–ø–æ–ª–Ω–∏–º –ø–æ–ª—è:

   ```
   PRIVATE_KEY="deployer_private_key"

   AMOY_RPC_URL="RPC_URL"

   POLYGON_API_KEY="API_KEY"
   WETH_ADDRESS=""
   ```

`WETH_ADDRESS` - –∞–¥—Ä–µ—Å WETH —Ç–æ–∫–µ–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–Ω–µ—Ç–∞ –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ–º, —Ç.–∫ –Ω–∞—à —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç  –∑–∞–¥–µ–ø–ª–æ–∏—Ç –µ–≥–æ.

–î–ª—è –º–µ–π–Ω–Ω–µ—Ç–∞, –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–±—É–µ–º—É—é —Å–µ—Ç—å –≤ `hardhat.config.ts` –∏ `.env` –∞ —Ç–∞–∫–∂–µ —É–∫–∞–∑–∞—Ç—å `WETH_ADDRESS` –≤ —ç—Ç–æ–π —Å–µ—Ç–∏.

7) –°–æ–∑–¥–∞–¥–∏–º ignition modules –¥–ª—è –¥–µ–ø–ª–æ—è

–î–ª—è —ç—Ç–æ–≥–æ –≤ –ø–∞–ø–∫–µ `ignition/modules/` —Å–æ–∑–¥–∞–¥–∏–º –º–æ–¥—É–ª—å –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –¥–µ–ø–ª–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –≤ —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```typescript
//UniswapV3.ts —Ñ–∞–π–ª

import { buildModule } from "@nomicfoundation/hardhat-ignition/modules";
import 'dotenv/config';

export default buildModule('UniswapV3', (m) => {
  // –ü–æ–ª—É—á–∞–µ–º WETH –∞–¥—Ä–µ—Å –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –¥–µ–ø–ª–æ–∏–º –Ω–æ–≤—ã–π, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
  const wethAddress = process.env.WETH_ADDRESS;
  const weth = wethAddress 
    ? m.contractAt("WETH9", wethAddress) 
    : m.contract("WETH9");
  
  // –î–µ–ø–ª–æ–∏–º —Ñ–∞–±—Ä–∏–∫—É
  const uniswapV3Factory = m.contract("UniswapV3Factory");

  // –î–µ–ø–ª–æ–∏–º —Å–≤–∞–ø —Ä–æ—É—Ç–µ—Ä
  const swapRouter = m.contract("SwapRouter", [uniswapV3Factory, weth], {
    after: [weth, uniswapV3Factory],
  });

  // –î–µ–ø–ª–æ–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è NFT-–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞
  const NFTDescriptor = m.library("NFTDescriptor");
  const nativeCurrencyLabelBytes = '0x46554e4e594d4f4e455900000000000000000000000000000000000000000000'; // cast format-bytes32-string "FUNNYMONEY"
  // –≠—Ç–∏ –±–∞–π—Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω–æ–π –≤–∞–ª—é—Ç—ã —Å–µ—Ç–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ bytes32.
  // "FUNNYMONEY" - —Ç–µ—Å—Ç–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∏–º—è —Ä–µ–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã –≤–∞—à–µ–π —Å–µ—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "ETH" –¥–ª—è Ethereum).
  
  // –î–µ–ø–ª–æ–∏–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è NFT –ø–æ–∑–∏—Ü–∏–π
  const nonfungibleTokenPositionDescriptor = m.contract("NonfungibleTokenPositionDescriptor", [weth, nativeCurrencyLabelBytes], {
    after: [weth],
    libraries: {
      NFTDescriptor: NFTDescriptor,
    }
  });

  // –î–µ–ø–ª–æ–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä NFT –ø–æ–∑–∏—Ü–∏–π
  const nonfungibleTokenPositionManager = m.contract("NonfungiblePositionManager", [uniswapV3Factory, weth, nonfungibleTokenPositionDescriptor], {
    after: [uniswapV3Factory, weth, nonfungibleTokenPositionDescriptor]
  });

  // –î–µ–ø–ª–æ–∏–º QuoterV2 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Ü–µ–Ω
  const quoterV2 = m.contract("QuoterV2", [uniswapV3Factory, weth], {
    after: [uniswapV3Factory, weth],
  })

  // –î–µ–ø–ª–æ–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º—É–ª—å—Ç–∏–≤—ã–∑–æ–≤–æ–≤
  const uniswapInterfaceMulticall = m.contract("UniswapInterfaceMulticall");
  
  // –î–µ–ø–ª–æ–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Multicall2
  const multicall2 = m.contract("Multicall2");

  return {
    weth,
    uniswapV3Factory,
    swapRouter,
    nonfungibleTokenPositionDescriptor,
    nonfungibleTokenPositionManager,
    quoterV2,
    uniswapInterfaceMulticall,
    multicall2
  };
});
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã Uniswap V3 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ö–µ—à –±–∞–π—Ç–∫–æ–¥–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ UniswapV3Pool –∏ –∑–∞–º–µ–Ω–∏—Ç—å –µ–≥–æ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ PoolAddress.sol.

1) –°–æ–∑–¥–∞–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ö–µ—à–∞:

```javascript
// computeInitCodeHash.js —Ñ–∞–π–ª

const { ethers } = require('ethers');
const fs = require('fs');
const path = require('path');

const jsonFilePath = path.resolve(__dirname, './artifacts/src/v3-core/UniswapV3Pool.sol/UniswapV3Pool.json');

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è ABI JSON —Ñ–∞–π–ª–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è INIT_CODE_HASH
async function computeInitCodeHash() {
  try {
    // –ß—Ç–µ–Ω–∏–µ ABI JSON —Ñ–∞–π–ª–∞
    const contractJson = JSON.parse(fs.readFileSync(jsonFilePath, 'utf8'));

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –±–∞–π—Ç–∫–æ–¥–∞ –≤ ABI JSON —Ñ–∞–π–ª–µ
    if (!contractJson.bytecode) {
      throw new Error('–ë–∞–π—Ç–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ ABI JSON —Ñ–∞–π–ª–µ.');
    }

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ INIT_CODE_HASH —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∞–π—Ç–∫–æ–¥–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    const computedInitCodeHash = ethers.keccak256(contractJson.bytecode);

    // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    console.log('INIT_CODE_HASH:', computedInitCodeHash);
    return computedInitCodeHash;
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ INIT_CODE_HASH:', error);
  }
}

// –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
computeInitCodeHash();
```

2) –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã:
   ```bash
   npx hardhat compile
   ```

3) –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∑–∞–ø–æ–ª–Ω—è–µ–º –µ–≥–æ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
   ```
   PRIVATE_KEY="–≤–∞—à_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á"
   AMOY_RPC_URL="amouy_RPC_URL"
   POLYGON_API_KEY="–≤–∞—à_api_–∫–ª—é—á_polygonscan"
   WETH_ADDRESS="–ê–¥—Ä–µ—Å_–ï—Å–ª–∏_–ú–µ–π–Ω_–Ω–µ—Ç"
   ```

4) –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ö–µ—à–∞:
   ```bash
   node computeInitCodeHash.js
   ```

5) –ü–æ–ª—É—á–µ–Ω–Ω—ã–π —Ö–µ—à –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ src/v3-periphery/libraries/PoolAddress.sol:
   ```solidity
   bytes32 internal constant POOL_INIT_CODE_HASH = –ü–æ–ª—É—á–µ–Ω–Ω—ã–π–•–µ—à;
   ```

## –î–µ–ø–ª–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –∫ –¥–µ–ø–ª–æ—é —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤.

1) –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã:
   ```bash
   npx hardhat compile
   ```

3) –î–µ–ø–ª–æ–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã Uniswap V3:
   ```bash
   npx hardhat ignition deploy ignition/modules/UniswapV3.ts --network amoy --deployment-id amoy --verify
   ```

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è, –∞–¥—Ä–µ—Å–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/ignition/deployments/[network_name]/deployed_addresses.json`.

_–í–∞–∂–Ω–æ!_ Ignitian –ø–ª–∞–≥–∏–Ω –∏–Ω–æ–≥–¥–∞ —Å–±–æ–∏—Ç, –ø–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ —É –≤–∞—Å –≤—ã–ª–µ–∑–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞ —Å nonces, –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –µ–≥–æ –ø–æ–∫–∞ –æ–Ω –Ω–∞ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –≤—Å–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã. –£–º–Ω—ã–π –ø–ª–∞–≥–∏–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç, –∫–∞–∫–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–µ –∑–∞–¥–µ–ø–ª–æ–∏–Ω—ã –∏ –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∏ –≤—Å–µ —Å–¥–µ–ª–∞–µ—Ç.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–§–æ—Ä–∫ –∏ –¥–µ–ø–ª–æ–π Uniswap V3 —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–µ–π, –Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ –ø–æ–¥—Ö–æ–¥–æ–º —ç—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º. –í —ç—Ç–æ–º –≥–∞–π–¥–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Hardhat Ignition - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤.

Hardhat Ignition –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–∏—Å–∞—Ç—å –≤—Å—é —Ü–µ–ø–æ—á–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ –≤ –æ–¥–Ω–æ–º –º–æ–¥—É–ª–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–µ–ø–ª–æ—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –µ–≥–æ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –Ω–∞ Etherscan

–í–∞–∂–Ω—ã–º –∞—Å–ø–µ–∫—Ç–æ–º —Ä–∞–±–æ—Ç—ã —Å Uniswap V3 —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ `POOL_INIT_CODE_HASH`, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –∞–¥—Ä–µ—Å–æ–≤ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –ø—É–ª–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏, –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é JavaScript-—Å–∫—Ä–∏–ø—Ç–∞.

–ï—Å–ª–∏ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —Ç–æ –º—ã –¥–ª—è –≤–∞—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ [–≥–æ—Ç–æ–≤—ã–π](https://github.com/fullstack-development/Uniswap-v3-Fork-SC/tree/main) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –¥–µ–ø–ª–æ—è.

## –°—Å—ã–ª–∫–∏:

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Uniswap V3](https://docs.uniswap.org/contracts/v3/overview)
- [–ö–Ω–∏–≥–∞ –ø–æ Uniswap V3](https://uniswapv3book.com/)
- [Github - Uniswap V3 Core](https://github.com/Uniswap/v3-core)
- [Github - Uniswap V3 Periphery](https://github.com/Uniswap/v3-periphery)
- [Hardhat](https://hardhat.org/)
- [Hardhat Ignition](https://hardhat.org/ignition/docs/getting-started)
- [OpenZeppelin Contracts](https://github.com/OpenZeppelin/openzeppelin-contracts)
- [Multicall2 —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç](https://github.com/makerdao/multicall)
- [API –∫–ª—é—á–∏ –¥–ª—è Polygon Amoy](https://amoy.polygonscan.com/)
