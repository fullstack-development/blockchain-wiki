# EIP-7702: Set Code for EOAs

**–ê–≤—Ç–æ—Ä:** [–ü–∞–≤–µ–ª –ù–∞–π–¥–∞–Ω–æ–≤](https://github.com/PavelNaydanov) üïµÔ∏è‚Äç‚ôÇÔ∏è

**EIP-7702: Set Code for EOAs** - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å **–Ω–æ–≤—ã–π —Ç–∏–ø** —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤ [EIP-2718: Typed Transaction Envelope](https://eips.ethereum.org/EIPS/eip-2718), —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∫ Externally Owned Accounts (EOAs) –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∫–æ–¥ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

EIP-7702 —è–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –≤ –æ–±–ª–∞—Å—Ç–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ —Ä–∞–º–∫–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Ethereum –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º ["Pectra"](https://ethereum.org/en/roadmap/pectra/).

–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –∫ EOA –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥ –≤ –µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–∑–æ–≤–∞ (delegateCall), —Ç–æ–ª—å–∫–æ –Ω–µ –¥–ª—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –∞ –¥–ª—è EOA.

![](./images/eip-7702-flow.png)

–£ —Å—É—â–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç –≤ Ethereum –≤—Å–µ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ –ø–æ–ª–µ **code**. –¢–æ–ª—å–∫–æ —Ä–∞–Ω—å—à–µ, –¥–ª—è EOA, —ç—Ç–æ –ø–æ–ª–µ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –ø—É—Å—Ç—ã–º, –∞ –¥–ª—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ —Ç–∞–º –Ω–∞—Ö–æ–¥–∏–ª—Å—è –±–∞–π—Ç–∫–æ–¥.

–¢–µ–ø–µ—Ä—å –¥–ª—è EOA, –≤ –ø–æ–ª–µ **code**, –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∞–¥—Ä–µ—Å –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ —Å–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º (**0xef0100** || address). –ü–æ —Å—É—Ç–∏, –ø—Ä–µ—Ñ–∏–∫—Å - —ç—Ç–æ  —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –º–∞–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ —ç—Ç–æ –∞–¥—Ä–µ—Å –¥–ª—è –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –Ω–µ –±–∞–π—Ç-–∫–æ–¥ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

–ì–ª–æ–±–∞–ª—å–Ω–æ, EIP-7702 –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ UX –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∑–∞ —Å—á–µ—Ç –Ω–µ–±–æ–ª—å—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–Ω—É—Ç—Ä–∏ Ethereum. –ü—Ä–∏ –ø–æ–º–æ—â–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –º–æ–≥—É—Ç —Ä–µ—à–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–∏ –∑–∞–¥–∞—á–∏:
- **–ë–∞—Ç—á–∏–Ω–≥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, approve –∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –≠—Ç–æ —Ç–æ —á–µ–≥–æ —Ç–∞–∫ –¥–æ–ª–≥–æ –∂–¥–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–æ—à–µ–ª—å–∫–æ–≤.
- **–ë–µ–∑–≥–∞–∑–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–ª–∏ —Å–ø–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–ø–ª–∞—Ç–∞ –≥–∞–∑–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –≥–∞–∑ –≤ ERC-20 —Ç–æ–∫–µ–Ω–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ª—É—á—à–∏—Ç—å –æ–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ—à–µ–ª—å–∫–æ–≤ –Ω–æ–≤—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—â–µ –Ω–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–π –≤–∞–ª—é—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã –≥–∞–∑–∞.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –¥–æ—Å—Ç—É–ø–æ–º**: –í—ã–¥–∞—á–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.
- **–ú–µ—Ö–∞–Ω–∏–∑–º—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞**: –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤—ã–≤–æ–¥ –∞–∫—Ç–∏–≤–æ–≤ –∏–ª–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–∫—Ç–∏–≤–∞–º–∏ –∫–æ—à–µ–ª—å–∫–∞.
- **–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ**.

## –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫–æ–¥–∞

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞–∑–±–µ—Ä–µ–º –∏–∑ —á–µ–≥–æ —Å–æ—Å—Ç–æ–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –∫ EOA.

–¢–µ–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Ö–æ–∂–µ –Ω–∞ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ç–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ [EIP-2718: Typed Transaction Envelope](https://eips.ethereum.org/EIPS/eip-2718):

- **TransactionType** - —Ç–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ä–∞–≤–µ–Ω `0x04`.
- **TransactionPayload** - –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ç–µ–º, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–ª–µ `authorization_list`.

![](./images/eip-7702-set-eoa-code-tx.png)

–ü–æ–ª–µ `authorization_list` - —ç—Ç–æ tuple, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫:

```js
authorization_list = [[
  chain_id, // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ç–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ
  address, // –ê–¥—Ä–µ—Å —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –∫—É–¥–∞ –±—É–¥–µ—Ç –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—ã–∑–æ–≤
  nonce, // –¢–µ–∫—É—â–∏–π nonce EOA
  y_parity, // –î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ EOA –∞–∫–∫–∞—É–Ω—Ç–∞
  r, // –î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ EOA –∞–∫–∫–∞—É–Ω—Ç–∞
  s // –î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ EOA –∞–∫–∫–∞—É–Ω—Ç–∞
], ...]
```

–ö–∞–∫ –∏ –ª—é–±—É—é –¥—Ä—É–≥—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å –µ–µ, –∞ –ø–æ—Å–ª–∞–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ —Å–µ—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∑–∂–µ.

–ü–æ—ç—Ç–æ–º—É —Ç—É—Ç –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –µ—Å–ª–∏ `chain_id` –≤ `authorization_list` –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–∞–≤–Ω—ã–º 0, —Ç–æ —ç—Ç–æ –±—É–¥–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ EOA —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤–æ –≤—Å–µ—Ö EVM-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —Å–µ—Ç—è—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö EIP-7702.

**–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

1. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥–ø–∏—Å—å, —Ä–∞–∑—Ä–µ—à–∞—é—â–∞—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ EOA, –±—ã–ª–∞ –≤–∞–ª–∏–¥–Ω–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ç—è—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã `nonce` –±—ã–ª –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –≤ —ç—Ç–∏—Ö —Å–µ—Ç—è—Ö, –∏–Ω–∞—á–µ –ø–æ–¥–ø–∏—Å—å –±—É–¥–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–∞ –¥–ª—è –∫–∞–∫–æ–π-—Ç–æ –∏–∑ —Å–µ—Ç–µ–π. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç, –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω—É –ø–æ–¥–ø–∏—Å—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫–æ–¥ –∫ EOA —Å—Ä–∞–∑—É –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ç—è—Ö.

2. –ü–æ–ª–µ `authorization_list` –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–∞–∑–Ω—ã–º–∏ EOA. –ü—Ä–∏ —ç—Ç–æ–º –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç—Ä–µ—Ç—å—è —Å—Ç–æ—Ä–æ–Ω–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–µ–∑–≥–∞–∑–æ–≤–æ–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–¥–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º EOA.

3. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–Ω–æ–≤–∞ —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ–π EOA –æ–±—ã—á–Ω—ã–º (–æ—Ç–∫—Ä–µ–ø–∏—Ç—å —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–µ `address` –≤ `authorization_list` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ 0.

4. –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞ `authorization_list` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π, —Ç–æ –æ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –≤–∞–ª–∏–¥–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è.

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –∫ —Å–≤–æ–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É, –≤–∫–ª—é—á–∞—é—â–µ–µ: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ü–µ–ø–æ—á–∫–∏, –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥, –∞–¥—Ä–µ—Å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. –ë–æ–ª—å—à–µ –æ—Ç –Ω–µ–≥–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç.

–≠—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ —Å–µ—Ç—å —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ EOA –Ω–∏–∫—É–¥–∞ –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç –∏ —Å –Ω–∏–º –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–∞–º –∞–∫–∫–∞—É–Ω—Ç–∞. –ü–æ—ç—Ç–æ–º—É –≤—Å–µ —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å—é –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç—å –µ–≥–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞—Ç—å.

–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π.

–í—Å—Ç—Ä–µ—Ç–∏—Ç—å –ø–æ–¥–æ–±–Ω–æ–µ –º–æ–∂–Ω–æ —É–∂–µ —Å–µ–π—á–∞—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä, Metamask –≤—Å—Ç—Ä–æ–∏–ª EIP-7702 –≤ —Å–≤–æ—é —Ñ–∏—á—É "[Smart Account](https://support.metamask.io/configure/accounts/what-is-a-smart-account/)". –î–ª—è —ç—Ç–æ–≥–æ Metamask —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, —Ç–æ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–≤–æ–¥—è —Å–≤–æ–π EOA –Ω–∞ Smart Account, –±—É–¥–µ—Ç –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º –æ—Ç Metamask.

![](./images/eip-7702-metamask-switch-page.png)
![](./images/eip-7702-metamask-confirm-set-code.png)

## –ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞–∑–±–µ—Ä–µ–º –Ω—é–∞–Ω—Å—ã —Ä–∞–±–æ—Ç—ã EIP-7702. –†–∞–±–æ—á–∏–µ –ø—Ä–∏–º–µ—Ä—ã –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ Foundry, –∫–æ—Ç–æ—Ä—ã–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ Cheatcodes.

```solidity
function signDelegation(address implementation, uint256 privateKey)
    external
    returns (SignedDelegation memory signedDelegation);

function attachDelegation(SignedDelegation calldata signedDelegation) external;

function signAndAttachDelegation(address implementation, uint256 privateKey)
    external
    returns (SignedDelegation memory signedDelegation);
```

–≠—Ç–∏ Cheatcodes –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—é –∫–æ–¥–∞ –∫ EOA (signDelegation) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Å–µ—Ç—å (attachDelegation) –ø—Ä—è–º–æ –≤ —Ç–µ—Å—Ç–∞—Ö.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã EIP-7702 —Ä–∞–±–æ—Ç–∞–ª, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∫–æ–¥ –¥–ª—è evm –≤–µ—Ä—Å–∏–∏ –Ω–µ –Ω–∏–∂–µ "prague". –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ `foundry.toml`.

```solidity
// foundry.toml
evm_version = "prague"
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç –∫–æ–¥ –∫ EOA –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ —Ç–µ—Å—Ç–∞—Ö Foundry —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
// –û–±—ä—è–≤–ª—è–µ–º StdCheats.Account public user;
...

function test_attachCode() external {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–æ–¥–∞ —É EOA user
    console.logBytes(user.addr.code); // 0x

    // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
    Vm.SignedDelegation memory signedDelegation = vm.signDelegation(address(delegation), user.key);

    vm.startBroadcast(operator.key);

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∫ user. –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç operator, –∞ –Ω–µ user
    vm.attachDelegation(signedDelegation);

    vm.stopBroadcast();

    console.logBytes(user.addr.code); //0xef01005615deb798bb3e4dfa0139dfa1b3d433cc23b72f
}
```

–ü–æ —Å—É—Ç–∏, —Ç–µ—Å—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ–≥–æ –¥–≤–∞ —ç—Ç–∞–ø–∞ –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫–æ–¥–∞.

![](./images/eip-7702-foundry-test-flow.png)

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `test_attachCode` –≤ [Delegation.t.sol](./contracts/attachCode/Delegation.t.sol).

### –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ EOA.

–ë–æ–ª–µ–µ —Ç–æ–≥–æ, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ç–∞–∫–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –Ω–µ –≤—ã–∑–≤–∞—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ EOA, –ø–æ—ç—Ç–æ–º—É –Ω–µ–ª—å–∑—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ EOA.

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ EOA. –¢–æ –µ—Å—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–∞–º–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –Ω–µ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ.

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ä–µ–∞–ª–∏–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç [Delegation.sol](./contracts/).

```solidity
contract Delegation {
    uint256 private _value;

    constructor(uint256 initialValue) {
        _value = initialValue;
    }

    function setValue(uint256 newValue) external {
        _value = newValue;
    }

    function getValue() external view returns (uint256) {
        return _value;
    }
}
```

–í —Ç–µ—Å—Ç–µ –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ EOA:

```solidity
// Delegation.t.sol
function test_workWithStorage(uint256 value) external {
    // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –∫–æ–¥ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ Delegation –∫ EOA user
    ...

    // Step 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ user –ø—É—Å—Ç–æ–µ, –∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ delegation –Ω–µ—Ç

    // –í—ã–∑–æ–≤ getValue —á–µ—Ä–µ–∑ user –≤–µ—Ä–Ω–µ—Ç 0, —Ç–∞–∫ –∫–∞–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ user –ø—É—Å—Ç–æ–µ
    assertEq(Delegation(user.addr).getValue(), 0);
    // –í—ã–∑–æ–≤ getValue —á–µ—Ä–µ–∑ delegation –≤–µ—Ä–Ω–µ—Ç _INITIAL_VALUE, —Ç–∞–∫ –∫–∞–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ delegation –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∏ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
    assertEq(delegation.getValue(), _INITIAL_VALUE);

    // Step 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ user
    Delegation(user.addr).setValue(value);

    // –í—ã–∑–æ–≤ getValue —á–µ—Ä–µ–∑ user –≤–µ—Ä–Ω–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ value
    assertEq(Delegation(user.addr).getValue(), value);
    //–í—ã–∑–æ–≤ getValue —á–µ—Ä–µ–∑ delegation –≤–µ—Ä–Ω–µ—Ç _INITIAL_VALUE, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
    assertEq(delegation.getValue(), _INITIAL_VALUE);
}
```

–¢–µ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ Delegation –Ω–∏—á–µ–≥–æ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ EOA. –í —Ü–µ–ª–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ EOA –∏ —Å–∞–º–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ - —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

![](./images/eip-7702-storage-example.png)

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞ `test_workWithStorage` –≤ [Delegation.t.sol](./contracts/storageExample/Delegation.t.sol).

_–í–∞–∂–Ω–æ!_ –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –¥–ª—è immutable –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±—É–¥—É—Ç —á–∞—Å—Ç—å—é –±–∞–π—Ç–∫–æ–¥–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

```solidity
contract Delegation {
    uint256 immutable private _value;

    constructor(uint256 value) {
        _value = value;
    }

    function getValue() external view returns (uint256) {
        return _value;
    }
}
```

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
function test_workWithStorage(uint256 initialValue) external {
    StdCheats.Account memory user = makeAccount("User");
    StdCheats.Account memory operator = makeAccount("Operator");

    // –î–µ–ø–ª–æ–∏–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç Delegation
    Delegation delegation = new Delegation(initialValue);

    // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –∫–æ–¥ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ Delegation –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegation), user.key);
    vm.stopBroadcast();

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ user –Ω–µ –ø—É—Å—Ç–æ–µ
    assertEq(Delegation(user.addr).getValue(), initialValue);
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ msg.sender == tx.origin

–†–∞–Ω—å—à–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —É—Å–ª–æ–≤–∏–µ `tx.origin == msg.sender` –¥–ª—è –¥–≤—É—Ö –≤–µ—â–µ–π:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ EOA, —Ç–∞–∫ –∫–∞–∫ `tx.origin` –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º.
2. –ó–∞—â–∏—Ç–∏—Ç—å –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞. –°—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –≤—Ç–æ—Ä–æ–π –≤—Ö–æ–¥ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º.

_–í–∞–∂–Ω–æ!_ –ï—Å–ª–∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ EOA –¥–µ–ª–∞–µ—Ç –≤—ã–∑–æ–≤ –∫ –¥—Ä—É–≥–æ–º—É —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—É, —Ç–æ `msg.sender` —Ä–∞–≤–Ω—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å—É EOA. –ò –∑–¥–µ—Å—å –ø–æ–∫–∞ `tx.origin` —Ä–∞–≤–Ω—è–µ—Ç—Å—è `msg.sender`.

![](./images/eip-7702-sender-and-origin-case-1.png)

–ù–∞ —Å—Ö–µ–º–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω –ø–æ—Ç–æ–∫ –≤—ã–∑–æ–≤–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—É `Target` —á–µ—Ä–µ–∑ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç `Delegation`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Å–≤–æ–∏–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º –≤—ã–∑–æ–≤ –Ω–∞ —Å–≤–æ–π –∂–µ –∞–¥—Ä–µ—Å, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç—Å—è –∫ —Å–º–∞—Ä—Ç- –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É `Delegation`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç `Target`. –í–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–≤–µ–Ω `msg.sender` –∏ `tx.origin`.

–ù–æ —Ç–µ–ø–µ—Ä—å, –∫–∞–∫ –æ–±–æ–π—Ç–∏ —É—Å–ª–æ–≤–∏–µ, —á—Ç–æ–±—ã `tx.origin` –∏–∑–º–µ–Ω–∏–ª—Å—è. EIP-7702 –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ª—é–±—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã–∑—ã–≤–∞—Ç—å –µ–≥–æ –º–æ–∂–µ—Ç –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –∞–∫–∫–∞—É–Ω—Ç, –µ—Å–ª–∏ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏–Ω–æ–µ. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–¥–µ—Å—å `msg.sender` –Ω–µ –±—É–¥–µ—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å `tx.origin`, –µ—Å–ª–∏ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –±—É–¥–µ—Ç –∏—Å—Ö–æ–¥–∏—Ç—å –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ EOA.

![](./images/eip-7702-sender-and-origin-case-2.png)

–ù–∞ —Å—Ö–µ–º–µ, –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å–≤–æ–∏–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–¥—Ä–µ—Å–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ –∏—Ç–æ–≥—É `tx.origin` –Ω–µ –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω `msg.sender`.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ –ª–µ–≥–∫–æ. –ü–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç [Target](./contracts/condition/Delegation.sol), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–∑–≤–æ–ª—è—Ç—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å value —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `tx.origin != msg.sender`.

```solidity
// Target
function setValue(uint256 newValue) external {
    if (tx.origin == msg.sender) {
        revert EOACallIsNotAllowed();
    }

    _value = newValue;
}
```

–ü—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –∫ EOA –±—É–¥–µ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç [Delegation](./contracts/condition/Delegation.sol), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å –≤—ã–∑–æ–≤ `setValue()` –Ω–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ `Target`.

```solidity
contract Delegation {
    function setValue(address target, uint256 value) external {
        Target(target).setValue(value);
    }
}
```

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
function test_checkCondition(uint256 value) external {
    Vm.SignedDelegation memory signedDelegation = vm.signDelegation(address(delegation), user.key);

    // –°–∏–º—É–ª–∏—Ä—É–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞–µ—Ç —Ü–µ–ª–µ–≤–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Ä–µ–≤–µ—Ä—Ç–∏—Ç—Å—è
    vm.expectRevert(Target.EOACallIsNotAllowed.selector);
    vm.prank(user.addr, user.addr);
    target.setValue(value);

    // Operator –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç Delegation –∫ user
    vm.startBroadcast(operator.key);
    vm.attachDelegation(signedDelegation);
    vm.stopBroadcast();

    // Operator –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é setValue() –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ Delegation –æ—Ç –∏–º–µ–Ω–∏ user,
    // –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç value –Ω–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ Target
    vm.prank(operator.addr, operator.addr);
    Delegation(user.addr).setValue(address(target), value);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–æ–π–¥–µ–Ω–∞)
    assertEq(target.getValue(), value);
}
```

–ü–æ –∏—Ç–æ–≥—É —Ç–µ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π –∫ EOA –º–æ–∂–µ—Ç –¥—Ä—É–≥–æ–π EOA, –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤ `tx.origin` –±—É–¥–µ—Ç –¥—Ä—É–≥–æ–π –∞–¥—Ä–µ—Å.

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `test_checkCondition` –≤ [Delegation.t.sol](./contracts/condition/Delegation.t.sol).

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞ –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç

–ë–æ–ª—å—à–µ –Ω–µ–ª—å–∑—è –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É `address(contract).code > 0`, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –∞–¥—Ä–µ—Å —è–≤–ª—è–µ—Ç—Å—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è EOA. –¢–µ–ø–µ—Ä—å EOA —Å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º —Ç–æ–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ 0.

![](./images/eip-7702-code-length-example.png)

–°–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–∫—Ä–µ–ø–∏–ª –∫ —Å–≤–æ–µ–º—É –∞–¥—Ä–µ—Å—É —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –¥—Ä—É–≥–∏—Ö —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (–∫–æ–≥–¥–∞ –æ–Ω msg.sender) –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è, –∫–∞–∫ –∞–∫–∫–∞—É–Ω—Ç —Å –∫–æ–¥–æ–º.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `msg.sender` - —ç—Ç–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –∫ –∞–∫–∫–∞—É–Ω—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
assembly {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–¥ msg.sender
    let ptr := mload(0x40)
    extcodecopy(caller(), ptr, 0, 32)
    let prefix := shr(232, mload(ptr))

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ prefix == 0xef0100
    isDelegated := eq(prefix, 0xef0100)
}
```

–î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –º–∞–≥–∏—á–µ—Å–∫–∏–º —á–∏—Å–ª–æ–º `0xef0100` –∏ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤ –Ω–∞—á–∞–ª–µ –±–∞–π—Ç–∫–æ–¥–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ª—é–±–æ–≥–æ –≤–∏–¥–∞ —Ç–æ–∫–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ callback —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—å —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç

EOA, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–∫—Ä–µ–ø–∏–ª –∫ —Å–µ–±–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –¥–ª—è ERC-721, ERC-777, –Ω–∞—Ç–∏–≤–Ω–æ–π –≤–∞–ª—é—Ç—ã, –Ω–∞—á–∏–Ω–∞–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è, –∫–∞–∫ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç.

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ EOA –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∞–∫—Ç–∏–≤—ã, –µ—Å–ª–∏ –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:


```js
receive() external payable {}
```
–∏–ª–∏
```js
function onERC721Received(address _operator, address _from, uint256 _tokenId, bytes _data) external returns(bytes4);
```

–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

![](./images/eip-7702-callback-functions-example.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∫ –ª—é–±–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É –ø—É—Å—Ç–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç [Delegation.sol](./contracts/receiveNativeCurrency/Delegation.sol), –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `receive()`.

```solidity
contract Delegation {}
```

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
function test_checkSendNativeCurrency(uint256 value) external {
    Vm.SignedDelegation memory signedDelegation = vm.signDelegation(address(delegation), user.key);

    // Operator –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç Delegation –∫ user
    vm.startBroadcast(operator.key);
    vm.attachDelegation(signedDelegation);
    vm.stopBroadcast();

    // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∞–ª—é—Ç—É, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Ä–µ–≤–µ—Ä—Ç–Ω–µ—Ç—Å—è
    (bool success,) = user.addr.call{value: value}(""); // success == false

    assertFalse(success);
}
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `test_checkSendNativeCurrency` –≤ [Delegation.t.sol](./contracts/receiveNativeCurrency/Delegation.t.sol).

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è EOA

EOA –º–æ–∂–µ—Ç –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º: –ø—Ä–∏–∫—Ä–µ–ø–ª—è—è –∏ –æ—Ç–∫—Ä–µ–ø–ª—è—è –∏—Ö. –í–Ω–æ–≤—å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∑–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º.

![](./images/eip-7702-collisions-example.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç—Ç–æ –≥–∏–ø–æ—Ç–µ–∑—ã –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–∏–º –¥–≤–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ [DelegationFirst.sol](./contracts/storageCollision/Delegation.sol) –∏ [DelegationSecond.sol](./contracts/storageCollision/Delegation.sol), –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø–µ—Ä–≤—ã–º —Å–ª–æ—Ç–æ–º –ø–∞–º—è—Ç–∏: –ø–µ—Ä–≤—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `uint256`, –≤—Ç–æ—Ä–æ–π `bytes32`.

```solidity
contract DelegationFirst {
    uint256 private _value;

    function setValue(uint256 newValue) external {
        _value = newValue;
    }

    function getValue() external view returns (uint256) {
        return _value;
    }
}

contract DelegationSecond {
    bytes32 private _hashValue;

    function setHash(bytes32 hashValue) external {
        _hashValue = hashValue;
    }

    function getHash() external view returns (bytes32) {
        return _hashValue;
    }
}
```

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
function test_storageCollision(uint256 value, bytes32 hashValue) external {
    // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –ø–µ—Ä–≤—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç
    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegationFirst), user.key);
    vm.stopBroadcast();

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    DelegationFirst(user.addr).setValue(value);
    assertEq(DelegationFirst(user.addr).getValue(), value);

    // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –≤—Ç–æ—Ä–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç
    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegationSecond), user.key);
    vm.stopBroadcast();

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º hash –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    DelegationSecond(user.addr).setHash(hashValue);
    assertEq(DelegationSecond(user.addr).getHash(), hashValue);

    // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –ø–µ—Ä–≤—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ
    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegationFirst), user.key);
    vm.stopBroadcast();

    assertNotEq(DelegationFirst(user.addr).getValue(), value); // –î–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ
}
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `test_test_storageCollision` –≤ [Delegation.t.sol](./contracts/storageCollision/Delegation.t.sol).

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∫–æ–ª–ª–∏–∑–∏–µ–π?**

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–≤–µ–¥–µ–Ω–∏–µ –æ—Å–æ–±–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤.

–ò–¥–µ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è (—ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Solidity –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [ERC-7201 Storage Namespaces Explained](https://eips.ethereum.org/EIPS/eip-7201) –∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø–æ–¥–æ–±–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–¥—É–º–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ö–µ—à–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –¥–ª—è —Å–ª–æ—Ç–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

```solidity
contract Delegation {
    struct MainStorage {
        uint256 value;
    }

    // keccak256(abi.encode(uint256(keccak256("MetaLampIsTheBest")) - 1)) & ~bytes32(uint256(0xff))
    bytes32 public constant MAIN_STORAGE_LOCATION = 0xd66e0df2d96f7ee8f3c31d9f50f7a36abdf7b3a8a2cbbfbe615a3abcc8b5af00;

    function _getMainStorage() private pure returns (MainStorage storage $) {
        assembly {
            $.slot := MAIN_STORAGE_LOCATION
        }
    }

    function getValue() external view returns (uint256) {
        MainStorage storage $ = _getMainStorage();

        // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –∫–æ—Ç–æ—Ä–æ–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º —Å–ª–æ—Ç–µ
        return $.value;
    }
}
```

_–í–∞–∂–Ω–æ!_ EIP-7201 –Ω–µ –∑–∞—â–∏—Ç–∏—Ç, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–∫—Ä–µ–ø–∏–ª –∫ —Å–≤–æ–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å–ª–æ—Ç –≤–∞—à–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

–¢–∞–∫–∂–µ, –∫–∞–∫ –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω –æ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ–¥ –∫ EOA.

### –†–∞–±–æ—Ç–∞ —Å –Ω–∞—Ç–∏–≤–Ω–æ–π –≤–∞–ª—é—Ç–æ–π

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–≤–∞ —Å–ª—É—á–∞—è –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–∫—Ä–µ–ø–∏–ª —Å–µ–±–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç:
1. –ë—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞ payable —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ë—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞ payable —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∏–ª–∞ –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∞–ª—é—Ç—É –Ω–∞ –¥—Ä—É–≥–æ–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç.

![](./images/eip-7702-work-with-native-currency.png)

–í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ, –Ω–∞—Ç–∏–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ –±–∞–ª–∞–Ω—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–æ-–≤—Ç–æ—Ä–æ–º - –Ω–∞ –±–∞–ª–∞–Ω—Å–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º.

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç—Ç–æ –≥–∏–ø–æ—Ç–µ–∑—ã –ø—Ä–∏–∫—Ä–µ–ø–∏–º –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç [Delegation.sol](./contracts/work-with-native-currency/Delegation.sol).

```solidity
contract Delegation {
    /// –û—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∞–ª—é—Ç—É –Ω–∞ –∞–¥—Ä–µ—Å–µ user
    function buy() external payable {}

    /// @notice –ü–µ—Ä–µ—Å—ã–ª–∞–µ–º –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∞–ª—é—Ç—É –Ω–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç target
    function buyAndSendToTarget(address target) external payable {
        (bool success, ) = target.call{value: msg.value}("");

        if (!success) {
            revert();
        }
    }
}

contract Target {
    // –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∞–ª—é—Ç—É
    receive() external payable {}
}
```

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–∞ –±—É–¥–µ—Ç –¥–≤–∞:

```solidity
function test_workWithNativeCurrency_buy(uint256 value) external {
    deal(operator.addr, value);

    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegation), user.key);
    vm.stopBroadcast();

    vm.prank(operator.addr);
    Delegation(user.addr).buy{value: value}();

    // –ù–∞—Ç–∏–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –±–∞–ª–∞–Ω—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    assertEq(user.addr.balance, value);
}

function test_workWithNativeCurrency_buyAndSendToTarget(uint256 value) external {
    deal(operator.addr, value);

    vm.startBroadcast(operator.key);
    vm.signAndAttachDelegation(address(delegation), user.key);
    vm.stopBroadcast();

    vm.prank(operator.addr);
    Delegation(user.addr).buyAndSendToTarget{value: value}(address(target));

    // –ù–∞—Ç–∏–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –±–∞–ª–∞–Ω—Å–µ target —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    assertEq(address(target).balance, value);
}
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤ `test_workWithNativeCurrency_buy` –∏ `test_workWithNativeCurrency_buyAndSendToTarget` –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [Delegation.t.sol](./contracts/work-with-native-currency/Delegation.t.sol).

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤, –∫–∞–∫ EIP-7702 –±—É–¥–µ—Ç —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –ø–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ —Å [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337).

–ù–∞ —É–¥–∏–≤–ª–µ–Ω–∏–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ! –í—Å–µ, –∫—Ç–æ –∏–º–µ–ª –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –Ω–∞ –±–∞–∑–µ ERC-4337, –º–æ–≥—É—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è ERC-4337 –Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª–µ–Ω –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ–¥–ø–∏—Å—å user operation) –±—ã–ª–∏ –≤–∞–ª–∏–¥–Ω—ã.

–í —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Ä–µ–±—è—Ç–∞ –∏–∑ eth-infinitism –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –∫–æ—Ç–æ—Ä–æ–º –≤ –æ–¥–Ω–æ–π —Å–≤—è–∑–∫–µ —Ä–∞–±–æ—Ç–∞—é—Ç ERC-4337 –∏ ERC-7702. –ü–µ—Ä–≤—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Å–ø–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∞–∑–∞, –≤—Ç–æ—Ä–æ–π –¥–ª—è –±–∞—Ç—á–∏–Ω–≥–∞ –æ–ø–µ—Ä–∞—Ü–∏–π.

–í—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫–æ–π –∞–∫–∫–∞—É–Ω—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```solidity
contract Simple7702Account is BaseAccount, IERC165, IERC1271, ERC1155Holder, ERC721Holder {
    /// –ê–¥—Ä–µ—Å entrypoint, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function entryPoint() public pure override returns (IEntryPoint) {
        return IEntryPoint(0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108);
    }

    /// –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function _validateSignature(
        PackedUserOperation calldata userOp,
        bytes32 userOpHash
    ) internal virtual override returns (uint256 validationData) {

        return _checkSignature(userOpHash, userOp.signature) ? SIG_VALIDATION_SUCCESS : SIG_VALIDATION_FAILED;
    }

    ...
}
```

–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞ ERC-4337 –∏ EIP-7702 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å—Ö–µ–º–µ –Ω–∏–∂–µ.

![](./images/eip-7702-and-erc-4337.png)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ **Simple7702Account** (–ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∫–æ–¥ —ç—Ç–æ–≥–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–Ω –º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ —á–µ—Ä–µ–∑ **bundler** –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

[–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞](https://github.com/eth-infinitism/account-abstraction/blob/releases/v0.8/contracts/accounts/Simple7702Account.sol).

–í EIP-7702 –≤—Ü–µ–ø–∏–ª–∏—Å—å –≤—Å–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏: viem, metamask, ZeroDev, Biconomy, Alchemy, Trust Wallet, Ambire –∏ –¥—Ä—É–≥–∏–µ. –û–Ω–∏ —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ EIP-7702 –≤ —Å–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã—Ö –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.

## Etherscan

Etherscan —Ç–æ–∂–µ –º–æ–ª–æ–¥–µ—Ü –∏ —Å—Ä–∞–∑—É –ø–æ–¥–¥–µ—Ä–∂–∞–ª EIP-7702. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω –≤—ã–≤–µ–ª –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ç–≤–µ—Ä—Ç–æ–≥–æ —Ç–∏–ø–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—É—é [—Å—Ç—Ä–∞–Ω–∏—Ü—É](https://etherscan.io/txnAuthList).

![](./images/eip-7702-etherscan-list-of-transactions.png)

–¢–∞–∫–∂–µ etherscan –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –∫–æ—Ç–æ—Ä–æ–º—É EOA –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

![](./images/eip-7702-etherscan-1.png)

–£–≤–∏–¥–µ—Ç—å, —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –Ω–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ –º–æ–∂–Ω–æ –∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ–ª–µ "Delegated Address", –∞ —É–≤–∏–¥–µ—Ç—å —Ç–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ø–æ–ª–µ "Other Attributes".

![](./images/eip-7702-etherscan-2.png)

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

–ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ EIP-7702 –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ–ª–Ω–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞, –æ–Ω –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç EOA –≤ "–£–º–Ω—ã–π —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç".

–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞, EIP-7702 –∏–º–µ–µ—Ç —Ä—è–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:

- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –≤—Å–µ –µ—â–µ –æ—á–µ–Ω—å –≤–∞–∂–µ–Ω**: —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∞–∫–∫–∞—É–Ω—Ç–æ–º, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã—Å—Ç—É–ø–∞—è –±–µ–∫–¥–æ—Ä–æ–º. –ü–æ—ç—Ç–æ–º—É –∑–∞—â–∏—Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–∞.

- **–ù–µ—Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è –º—É–ª—å—Ç–∏—Å–∏–≥–∞**: –ü–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º—É–ª—å—Ç–∏—Å–∏–≥ –Ω–∞ –±–∞–∑–µ EIP-7702, —Ç–∞–∫ –∫–∞–∫ —É –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –±—É–¥—É—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∞. –í—Å–µ–º –ø—Ä–∏–¥–µ—Ç—Å—è –¥–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º—É EOA. –ï–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –Ω–∞–¥–µ–ª—è–µ—Ç –µ–≥–æ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –≤–ª–∞—Å—Ç—å—é.

- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞**: –µ—Å–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —É—Ç–µ—Ä—è–Ω –∏–ª–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ EOA –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞, –Ω–æ —ç—Ç–æ –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞.

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**: –≤ –±—É–¥—É—â–µ–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã. EOA –∂–µ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —É—è–∑–≤–∏–º—ã –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏.

- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —ç—Å–∫—Ä–æ—É-—Å—á–µ—Ç–∞**: –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π EOA –∏–º–µ–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø–æ–ª–Ω–æ–º–æ—á–∏—è –∏ –º–æ–∂–µ—Ç –∏–∑—ä—è—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞.

## –í—ã–≤–æ–¥

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, EIP-7702 —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–º —à–∞–≥–æ–º –Ω–∞ –ø—É—Ç–∏ –∫ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞, –ø—Ä–∏–≤–Ω–æ—Å–∏—Ç –Ω–æ–≤—É—é —ç–Ω–µ—Ä–≥–∏—é –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É Ethereum –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–Ω–µ–¥—Ä—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏. –ö–∞–∫ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –±—É–¥—É—â–µ–º –æ–¥–Ω–æ–º—É –í–∏—Ç–∞–ª–∏–∫—É –∏–∑–≤–µ—Å—Ç–Ω–æ.

–¢–∞–∫–∂–µ –Ω–µ —Å—Ç–æ–∏—Ç –∑–∞–±—ã–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- –∫–æ–ª–ª–∏–∑–∏–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –∞–∫–∫–∞—É–Ω—Ç–∞
- —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ç—è—Ö
- –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ –ø–æ–¥–¥–µ—Ä–∂–∫—É ERC-721 –∏–ª–∏ ERC-777, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Ç–∏–≤–Ω–æ–π –≤–∞–ª—é—Ç—ã
- –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º—É–ª—å—Ç–∏—Å–∏–≥ –∏–ª–∏ —ç—Å–∫—Ä–æ—É-—Å—á–µ—Ç
- –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∏–º–µ–µ—Ç —Ä–µ—à–∞—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ EOA –Ω–∞ —Å–º–∞—Ä—Ç-–∞–∫–∫–∞—É–Ω—Ç—ã –ø–æ—Ç—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Ethereum. –ü–æ –º–µ—Ä–µ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã EIP-7702 –±—É–¥–µ—Ç –∏–≥—Ä–∞—Ç—å –≤–∞–∂–Ω–µ–π—à—É—é —Ä–æ–ª—å –≤ —É–ª—É—á—à–µ–Ω–∏–µ UI –∫–æ—à–µ–ª—å–∫–æ–≤, –ø–æ–≤—ã—à–µ–Ω–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–±–ª–∏–∂–∞—è –Ω–∞—Å –∫ –∫–æ–Ω–µ—á–Ω–æ–π —Ü–µ–ª–∏ ‚Äî –ø–æ–ª–Ω–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤.

# Links

1. Ethereum Improvement Proposals: [EIP-7702: Set Code for EOAs](https://eips.ethereum.org/EIPS/eip-7702)
2. [EIP-7702](https://www.cyfrin.io/glossary/eip-7702) –æ—Ç Cyfrin
3. [Solidity –∏ Ethereum, —É—Ä–æ–∫ #93 | EIP-7702: EOA code](https://www.youtube.com/live/NZQc6bQdW9g). –í–∏–¥–µ–æ –æ—Ç Ilya Krukowski. –ó–¥–µ—Å—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è EIP-7702 —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
4. [In-Depth Discussion on EIP-7702 and Best Practices](https://slowmist.medium.com/in-depth-discussion-on-eip-7702-and-best-practices-968b6f57c0d5) –æ—Ç SlowMist. –ó–¥–µ—Å—å –±–æ–ª—å—à–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Ç–æ–≥–æ, –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Ethereum
5. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è viem](https://viem.sh/docs/eip7702)
6. [What You Need to Know About EIP-7702 ‚ÄúSmart‚Äù Account](https://info.etherscan.com/what-you-need-to-know-about-eip-7702-smart-account/) –æ—Ç etherscan
7. [Deep Dive into Ethereum 7702 Smart Accounts: security risks, footguns and testing](https://www.youtube.com/watch?v=ZFN2bYt9gNE&ab_channel=TheRedGuild)
8. [Emergency EIP-7702 Wallet Recovery](https://medium.com/@BahadorGh/emergency-eip-7702-wallet-recovery-f4cc865f6341). –ò—Å—Ç–æ—Ä–∏—è –æ —Ç–æ–º, –∫–∞–∫ —Å–ª—É—á–∞–π–Ω–æ–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª–∏–ª–æ —É–≤–µ—Å—Ç–∏ –∞–∫—Ç–∏–≤—ã —Å –∫–æ—à–µ–ª—å–∫–∞.
9. [EIP-7702 overview](https://eip7702.io/)
10. [EIP7702: Closing the Gap Between EOAs and Smart Contracts](https://medium.com/valixconsulting/eip7702-closing-the-gap-between-eoas-and-smart-contracts-16b6f05584a9). –ó–¥–µ—Å—å –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä, –∫–∞–∫ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –≤ –æ–±–ª–∞—Å—Ç–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤.
11. [Awesome EIP-7702](https://github.com/fireblocks-labs/awesome-eip-7702). –ù–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –µ—â–µ –±–æ–ª—å—à–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤